# 2026-02-05

- build app
- integrated wallet and yellow network
- having some bug so added debug log

##  current workflow

### Wallet connect (RainbowKit + wagmi)

- User connects a wallet via `WalletButton` (RainbowKit).
- `YellowProvider` reads `address` + `walletClient` via `useAccount` / `useWalletClient`.

### Open channel (triggered by `useAuctionSession`)

- `useAuctionSession.joinAuction()` calls `openChannel()` from `YellowProvider`.
- `openChannel()` calls `yellowClient.openChannel()`.

### Yellow session auth (`yellowClient.openChannel`)

1. Generate session keypair (local, **not** the user wallet).
2. Connect to Clearnode WebSocket.
3. Fetch config (`get_config`) and resolve token.
4. Send `auth_request` with `session_key`.
5. Receive `auth_challenge`, sign via **EIP-712** with connected wallet.
6. Send `auth_verify`.
7. Request ledger balances.
   - If an open channel exists, reuse it.
   - Otherwise, create a new channel (`create_channel`).

### Session message signing

- App state or session messages are signed with the session key via `signSessionMessage()`.

### Deposit (resize)

- `deposit()` calls `resize_channel` with `allocate_amount`  
  (currently `amount * 100`).

### Withdraw

- Stubbed.
- On-chain close / withdraw is **not implemented** in the browser client.
